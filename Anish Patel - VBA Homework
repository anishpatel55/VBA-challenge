Attribute VB_Name = "Module1"
Sub stockmarket():

Dim ws As Worksheet

For Each ws In Worksheets
Dim volumecount As Double
Dim ticker As String
Dim yearlychange As Double
Dim percentchange As Double
Dim openstock As Double
Dim closestock As String
Dim summary_table_row As Integer
summary_table_row = 1
Dim WorksheetName As String
WorksheetName = ws.Name
Dim difference As Double
Dim change As Double



For i = 1 To ws.Cells(Rows.Count, 1).End(xlUp).Row

openstock = ws.Cells(i + 1, 3).Value
If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then
ticker = ws.Cells(i, 1).Value
closestock = ws.Cells(i, 6).Value

ws.Cells(summary_table_row, 11).Value = ws.Cells(i + 1, 14).Value - ws.Cells(i + 1, 15).Value

ws.Range("L" & summary_table_row).Value = percentchange
ws.Range("K" & summary_table_row).Value = yearlychange
ws.Range("J" & summary_table_row).Value = ticker
ws.Range("M" & summary_table_row).Value = volumecount
ws.Range("N" & summary_table_row).Value = closestock
ws.Range("O" & summary_table_row + 1).Value = openstock

summary_table_row = summary_table_row + 1
volumecount = 0




Else
volumecount = volumecount + ws.Cells(i, 7).Value

End If

Next i

ws.Range("J1").Value = "Ticker"
ws.Range("K1").Value = "Yearly Change"
ws.Range("L1").Value = "Percent Change"
ws.Range("M1").Value = "Total Stock Volume"
ws.Range("N1").Value = "Close"
ws.Range("O1").Value = "Open"
ws.Range("Q2").Value = "Greatest % Increase"
ws.Range("Q3").Value = "Greatest % Decrease"
ws.Range("Q4").Value = "Greatest Total Volume"
ws.Range("R1").Value = "Ticker"
ws.Range("S1").Value = "Value"

Next ws
End Sub








